<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Imagens | Delta Prompts</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../style.css">
</head>

<body>

<div id="menu"></div>
<script src="../menu-loader.js"></script>

<main>
  <h1>ğŸ¨ EdiÃ§Ã£o de Fotos</h1>
  <p style="color:#6b7280; margin-top:-10px;">
    Prompts criativos para transformar e estilizar suas fotos.
  </p>

  <div id="lista"></div>
</main>

<script>
const categoriaAtual = "Imagens";
const lista = document.getElementById("lista");

function limparPromptsAntigos() {
  let prompts = JSON.parse(localStorage.getItem("deltaPrompts")) || [];

  const removerTitulos = [
    "Cidade Futurista Brasileira",
    "Personagem RetrÃ´ Anos 90",
    "Logo Gamer Profissional",
    "Melhorar Qualidade da Foto",
    "CorreÃ§Ã£o de IluminaÃ§Ã£o"
  ];

  prompts = prompts.filter(p => 
    !(p.categoria === categoriaAtual && removerTitulos.includes(p.titulo))
  );

  localStorage.setItem("deltaPrompts", JSON.stringify(prompts));
}

function inserirPromptsPadrao() {
  let prompts = JSON.parse(localStorage.getItem("deltaPrompts")) || [];

  const titulosExistentes = prompts
    .filter(p => p.categoria === categoriaAtual)
    .map(p => p.titulo);

  const novos = [
    {
      id: Date.now() + 200,
      titulo: "Caricatura Profissional",
      categoria: categoriaAtual,
      conteudo: "Transforme esta foto em uma caricatura artÃ­stica mantendo identidade e traÃ§os marcantes. Exagere expressÃµes de forma divertida e equilibrada.",
      favorito: false
    },
    {
      id: Date.now() + 201,
      titulo: "Estilo Pintura Digital",
      categoria: categoriaAtual,
      conteudo: "Transforme esta foto em uma pintura digital artÃ­stica com textura de pincel e acabamento profissional, mantendo reconhecimento facial.",
      favorito: false
    },
    {
      id: Date.now() + 202,
      titulo: "Avatar Estilizado",
      categoria: categoriaAtual,
      conteudo: "Crie um avatar estilizado baseado nesta foto, com visual moderno e detalhes refinados, mantendo caracterÃ­sticas principais do rosto.",
      favorito: false
    },
    {
      id: Date.now() + 203,
      titulo: "Retrato CinematogrÃ¡fico",
      categoria: categoriaAtual,
      conteudo: "Aplique um efeito cinematogrÃ¡fico com ajuste de cores, contraste e profundidade, deixando a foto com aparÃªncia profissional.",
      favorito: false
    }
  ];

  novos.forEach(p => {
    if (!titulosExistentes.includes(p.titulo)) {
      prompts.push(p);
    }
  });

  localStorage.setItem("deltaPrompts", JSON.stringify(prompts));
}

function carregarPrompts() {
  lista.innerHTML = "";
  const prompts = JSON.parse(localStorage.getItem("deltaPrompts")) || [];

  prompts.filter(p => p.categoria === categoriaAtual).forEach(p => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <h3>${p.titulo}</h3>
      <p>${p.conteudo}</p>

      <div class="acoes">
        <button data-id="${p.id}" class="copiar">ğŸ“‹ Copiar</button>
        <button data-id="${p.id}" class="editar">âœï¸ Editar</button>
        <button data-id="${p.id}" class="apagar">ğŸ—‘ï¸ Apagar</button>
        <button data-id="${p.id}" class="favoritar">
          ${p.favorito ? "â¤ï¸" : "ğŸ¤"}
        </button>
      </div>
    `;

    lista.appendChild(card);
  });
}

lista.addEventListener("click", e => {
  const id = Number(e.target.dataset.id);
  if (!id) return;

  let prompts = JSON.parse(localStorage.getItem("deltaPrompts")) || [];
  const p = prompts.find(x => x.id === id);

  if (e.target.classList.contains("copiar")) {
    navigator.clipboard.writeText(p.conteudo);
  }

  if (e.target.classList.contains("editar")) {
    const t = window.prompt("Editar tÃ­tulo:", p.titulo);
    const c = window.prompt("Editar conteÃºdo:", p.conteudo);
    if (t && c) { p.titulo = t; p.conteudo = c; }
  }

  if (e.target.classList.contains("apagar")) {
    prompts = prompts.filter(x => x.id !== id);
  }

  if (e.target.classList.contains("favoritar")) {
    p.favorito = !p.favorito;
  }

  localStorage.setItem("deltaPrompts", JSON.stringify(prompts));
  carregarPrompts();
});

limparPromptsAntigos();
inserirPromptsPadrao();
carregarPrompts();
</script>

</body>
</html>
